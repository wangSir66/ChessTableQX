var res = {
    Update_bk:"game_picture/loadBg.png",

	Update_json:"Update.json",
	Login_json:"Login.json",
	
	Create_json:"createHomeTotal.json",
	Enter_json:"enter.json",
	Eenter_myRoom_json:"enter_myRoom.json",
	
	Home_json:"Home.json",
	Play_json:"Play.json",
    Play_Red20_json:"Red20Scene.json",
    Play_niuniu_json:"Play_niuniu.json",
    Play_shuyang_json:"Play_shuyang.json",
    Play_guanyun_json:"Play_guanyun.json",
    Play_guannan_json:"Play_guannan.json",
    Play_donghai_json:"Play_donghai.json",
    Play_nanjing_json:"Play_nanjing.json",
    Play_suqian_json:"Play_suqian.json",
    Play_xuzhou_json:"Play_xuzhou.json",
    Play_huaian_json:"Play_huaian.json",
    Play_huaianTTZ_json:"Play_huaianTTZ.json",
    Play_huaianCC_json:"Play_huaianCC.json",
    Play_HZTDH_json:"Play_HZTDH.json",
    Play_huaianERZ_json:"Play_huaianERZ.json",
    Play_rugao_json:"Play_rugao.json",
    Play_rugao_MJH_json:"Play_rugao_MJH.json",
    Play_rugao_qutang_23zhang_json:"Play_qutang_23zhang.json",
    Play_BPLZ_json:"Play_BPLZ.json",
    Play_HAHZ_json:"Play_HAHZ.json",
    Play_HA14D_json:"Play_HA14D.json",
    Play_tuantuanzhuan_json:"Play_tuantuanzhuan.json",
    Play_HZMJ_json:"Play_HZMJ.json",
    Play_MLHZ_json:"Play_MLHZ.json",
    Play_YYHZ_json:"Play_yueyanghongzhong.json",
    Play_TYHZ_json:"Play_TYHZ.json",
    Play_TYZZ_json:"Play_TYZZ.json",
    Play_doudizhuTY_json:"Play_doudizhuTY.json",
	Play_doudizhuTongYong_json:"Play_doudizhuTongYong.json",
	Play_doudizhuHBTY_json:"Play_doudizhuHBTY.json",
	Play_doudizhuQC_json:"Play_doudizhuQC.json",
    Play_NTHZ_json:"Play_NTHZ.json",
    Play_leiyangGMJ_json:"Play_leiyangGMJ.json",
    Play_tonghua_json:"Play_tonghua.json",
    Play_WuXueGeBan_json:"Play_wuXueGeBan.json",
    Play_paodekuai_json:"Play_paodekuai.json",
    Play_PaoDeKuai11_json:"Play_PaoDeKuai11.json",
	Play_PaoDeKuaiTY_json:"Play_PaoDeKuaiTY.json",
	Play_PaoDeKuaiJZ_json:"Play_PaoDeKuaiJZ.json",
	Play_PaoDeKuaiHuaian_json:"Play_PaoDeKuaiHuaian.json",
	Play_PaoDeKuaiHuaianNew_json:"Play_PaoDeKuaiHuaianNew.json",
	Play_PaoDeKuaiLYG_json:"Play_PaoDeKuaiLYG.json",
	Play_PaoDeKuaiXS_json:"Play_PaoDeKuaiLYG.json",
	Play_PaoDeKuaiNT_json:"Play_PaoDeKuaiNT.json",
	Play_PaoDeKuaiHaian_json:"Play_paodekuaiHaian.json",
	Play_PaoDeKuaiXuzhou_json:"Play_paodekuaiXuzhou.json",
	Play_PaoDeKuaiHBTY_json:"Play_PaoDeKuaiHBTY.json",
	Play_sanDaHa_json:"Play_sanDaHa.json",
	Play_baoPaiYZ_json:"Play_baoPaiYZ.json",
    Play_sanDaHaXiangTan_json:"Play_sanDaHaXiangTan.json",
    Play_sanDaHaNew_json:"Play_sanDaHaNew.json",
    Play_doudizhu_json:"Play_doudizhu.json",
    Play_doudizhuHuaiAn_json:"Play_doudizhuHuaiAn.json",
    Play_paohuzi_json:"Play_paohuzi.json",
    Play_liuhusao_json:"Play_liuhusao.json",
	Play_siyang_json:"Play_siyang.json",
    Play_siyanghh_json:"Play_siyanghh.json",
    Play_yanchenghh_json:"Play_yanchenghh.json",
    Play_ganyu_json:"Play_ganyu.json",
    Play_doudizhuXinZhou_json:"Play_doudizhuXinZhou.json",
    Play_changSha_json:"Play_changSha.json",
    Play_lianshui_json:"Play_lianshui.json",
	Play_yiyangMJ_json: "Play_yiyangMj.json",
	Play_yzchz_json:"Play_zplychz.json",
	Play_XinNingMJ_json:"Play_XinNingMJ.json",
	Block_json:"block.json",
	FangQiang_json:"fangQiang.json",
    Doudizhu_HeadNode_json:"Doudizhu_HeadNode.json",
    Doudizhu_CardNode_json:"Doudizhu_CardNode.json",
	Doudizhu_WaitNode_json:"Doudizhu_WaitNode.json",
	EndOne_json:"endOne.json",
    EndOne_wuXueGeBan_json:"endOne_wuXueGeBan.json",
	EndOne_shuyang_json:"endOne_shuyang.json",
    EndOne_guanyun_json:"endOne_guanyun.json",
    EndOne_guannan_json:"endOne_guannan.json",
    EndOne_donghai_json:"endOne_donghai.json",
    EndOne_nanjing_json:"endOne_nanjing.json",
    EndOne_suqian_json:"endOne_suqian.json",
    EndOne_xuzhou_json:"endOne_xuzhou.json",
    EndOne_tonghua_json:"endOne_tonghua.json",
    EndOne_huaian_json:"endOne_huaian.json",
    EndOne_huaianTTZ_json:"endOne_huaianTTZ.json",
    EndOne_huaianCC_json:"endOne_huaianCC.json",
    EndOne_HZTDH_json:"endOne_HZTDH.json",
    EndOne_huaianERZ_json:"endOne_huaianERZ.json",
    EndOne_rugao_json:"endOne_rugao.json",
    EndOne_BPLZ_json:"endOne_BPLZ.json",
    EndOne_rugao_MJH_json:"endOne_rugao_MJH.json",
    EndOne_HAHZ_json:"endOne_HAHZ.json",
    EndOne_NTHZ_json:"endOne_NTHZ.json",
    EndOne_MLHZ_json:"endOne_MLHZ.json",
    EndOne_YYHZ_json:"endOne_yueyanghongzhong.json",
    EndOne_TYHZ_json:"endOne_TYHZ.json",
    EndOne_TYZZ_json:"endOne_TYZZ.json",
    EndOne_tonghua_json:"endOne_tonghua.json",
    EndOne_tuantuanzhuan_json:"endOne_tuantuanzhuan.json",
    EndOne_HZMJ_json:"endOne_HZMJ.json",
    EndOne_paodekuai_json:"endOne_paodekuai.json",
    EndOne_PaoDeKuaiTY_json:"endOne_PaoDeKuaiTY.json",
    EndOne_PaoDeKuaiJZ_json:"endOne_PaoDeKuaiJZ.json",
    EndOne_PaoDeKuaiHuaian_json:"endOne_PaoDeKuaiHuaian.json",
    EndOne_PaoDeKuaiHuaianNew_json:"endOne_PaoDeKuaiHuaianNew.json",
    EndOne_PaoDeKuaiLYG_json:"endOne_PaoDeKuaiLYG.json",
    EndOne_PaoDeKuaiXS_json:"endOne_PaoDeKuaiXS.json",
    EndOne_PaoDeKuaiNT_json:"endOne_PaoDeKuaiNT.json",
    EndOne_PaoDeKuaiHaian_json:"endOne_paodekuaiHaian.json",
	EndOne_PaoDeKuaiXuzhou_json:"endOne_paodekuaiXuzhou.json",
	EndOne_PaoDeKuaiHBTY_json:"endOne_PaoDeKuaiHBTY.json",
    EndOne_sanDaHa_json:"endOne_sanDaHa.json",
    EndOne_baoPaiYZ_json:"endOne_baoPaiYZ.json",
    EndOne_sanDaHaXiangTan_json:"endOne_sanDaHaXiangTan.json",
    EndOne_doudizhu_json:"endOne_doudizhu.json",
    EndOne_doudizhuHuaiAn_json:"endOne_doudizhuHuaiAn.json",
    EndOne_HA14D_json:"endOne_HA14D.json",
    EndOne_siyang_json:"endOne_siyang.json",
    EndOne_yanchenghh_json:"endOne_yanchenghh.json",
    endOne_YZPHZ_json:"endOne_YZPHZ.json",
    endOne_YZLHS_json:"endOne_YZLHS.json",
    EndOne_ganyu_json:"endOne_ganyu.json",
    EndOne_changSha_json:"endOne_changSha.json",
    EndOne_lianshui_json:"endOne_lianshui.json",
    EndOne_leiyangGMJ_json:"endOne_leiyangGMJ.json",
    endOne_zplychz_json:"endOne_zplychz.json",
    EndOneView_XNMJ_json:"endOne_XinNingMJ.json",
    EndAll_wuXueGeBan_json:"endAll_wuXueGeBan.json",
    endAll_Poker_json:"endAll_Poker.json",
    EndAllShare_json:"shareGameOverInfo.json",
    EndAll_json:"endAll.json",
    EndAll_paohuzi_json:"endAll_YZPHZ.json",
    EndAll_doudizhu_json:"endAll_DDZTY.json",
    //EndAll_doudizhuTY_json:"endAll_DDZTY.json",
	CreateRoom_json:"createRoom.json",
    ShowFlow_json:"showFlowerTips.json",
    Play_rugao_SJ_json:"Play_rugao_SJ.json",
    EndOne_rugao_SJ_json:"endOne_rugao_SJ.json",
    Play_haian_json:"Play_haian.json",
    EndOne_haian_json:"endOne_haian.json",
    Play_haianbaida_json:"Play_haianbaida.json",
    EndOne_haianbaida_json:"endOne_haianbaida.json",
    Play_jinzhong_json:"Play_jinzhong.json",
    EndOne_jinzhong_json:"endOne_jinzhong.json",
    Play_guizhoupuding_json:"Play_guizhoupuding.json",
    Play_guizhouAnShun_json:"Play_guizhouAnShun.json",
    Play_guizhouSanDingLiangFang_json:"Play_guizhouSanDingLiangFang.json",
    Play_jiexiukoudian_json:"Play_jiexiukoudian.json",
    Play_koudian_json:"Play_koudian.json",
    Play_lvliangmajiang_json:"Play_lvliangmajiang.json",
	EndOne_koudian_json:"endOne_koudian.json",
	EndOne_goldkoudian_json:"endOne_goldkoudian.json",
    EndOne_lvliangmajiang_json:"endOne_lvliangmajiang.json",
    EndOne_jiexiukoudian_json:"endOne_jiexiukoudian.json",

	Play_lingshibianlong_json:"Play_lingshibianlong.json",
	EndOne_lingshibianlong_json:"endOne_lingshibianlong.json",

    Play_tuidaohu_json:"Play_tuidaohu.json",
    EndOne_tuidaohu_json:"endOne_tuidaohu.json",

    Play_doudizhuJZ_json:"Play_doudizhuJZ.json",
    EndOne_doudizhuJZ_json:"endOne_doudizhuJZ.json",

    Play_doudizhuGZ_json:"Play_doudizhuGZ.json",
    EndOne_doudizhuGZ_json:"endOne_doudizhuGZ.json",

    Play_doudizhuDaTong_json:"Play_doudizhuDaTong.json",
    EndOne_doudizhuDaTong_json:"endOne_doudizhuDaTong.json",

    Play_doudizhuHA_json:"Play_doudizhuHA.json",
    EndOne_doudizhuHA_json:"endOne_doudizhuHA.json",

    Play_rudong_json:"Play_rudong.json",
    EndOne_rudong_json:"endOne_rudong.json",

    Play_rugaoER_json:"Play_rugaoER.json",
    EndOne_rugaoER_json:"endOne_rugaoER.json",
	//Activity_json:"activity.json",
	// Act1:"act1.json",
	// Act2:"act2.json",
	// Act3:"act3.json",
	RestartTip_json:"restartGameTip.json",
	GameTip_json:"GameTip.json",
	PlayMJ_emoji_png:"chat/emoji_action_texture.png",
	PlayMJ_emoji_plist:"chat/emoji_action_texture.plist",
	PlayMJ_emoji_new_png:"chat/emoji.png",
	PlayMJ_emoji_new_plist:"chat/emoji.plist",
	Play_NiuShiBieYueYang_json:"Play_NiuShiBieYueYang.json",
	EndOne_NiuShiBieYueYang_json:"endOne_NiuShiBieYueYang.json",
	Play_DaMaZiZhuZhou_json:"Play_DaMaZiZhuZhou.json",
	EndOne_DaMaZiZhuZhou_json:"endOne_DaMaZiZhuZhou.json",

    Play_daYeDaGong_json:"Play_daYeDaGong.json",
    Play_tongShanDaGong_json:"Play_tongShanDaGong.json",
    Play_chongYangDaGun_json:"Play_chongYangDaGun.json",
    Play_daYe510K_json:"Play_daYe510K.json",
	Play_qianJiangQianFen_json:"Play_qianJiangQianFen.json",
    Play_wuXue510K_json:"Play_wuXue510K.json",
    Play_qiChunDaGong_json:"Play_qiChunDaGong.json",
    Play_chongYangHuaQuanJiao_json:"Play_chongYangHuaQuanJiao.json",

	Play_daZhaDan_json:"Play_yueYangDaZhaDan.json",

	//打炸弹特效
	daZhaDan_baodan : "daZhaDan/effect/baodan.plist",
	daZhaDan_dtz_dizha : "daZhaDan/effect/dtz_dizha.plist",
	daZhaDan_feiji : "daZhaDan/effect/feiji.plist",
	daZhaDan_liandui : "daZhaDan/effect/liandui.plist",
	daZhaDan_zhadan : "daZhaDan/effect/zhadan.plist",

	//打筒子特效
	DaTongZi_baodan : "daTongZi/effect/baodan.plist",
	DaTongZi_dtz_dizha : "daTongZi/effect/dtz_dizha.plist",
	DaTongZi_feiji : "daTongZi/effect/feiji.plist",
	DaTongZi_liandui : "daTongZi/effect/liandui.plist",
	DaTongZi_zhadan : "daTongZi/effect/zhadan.plist",
};

function initResourceDir() {
	var searthPaths = jsb.fileUtils.getSearchPaths();
    console.log("-------------initResourceDir start all searchPath:");
    for (var i = 0; i < searthPaths.length; i++) {
        console.log(searthPaths[i]);
    }

    var writablePath = jsb.fileUtils.getWritablePath();
    var appPath = "";
    if (cc.sys.OS_WINDOWS == cc.sys.os) {
        var appDirs = {};
        appDirs[MjClient.APP_TYPE.QXSYDTZ] = "../client";
        appDirs[MjClient.APP_TYPE.QXYYQP] = "../client";
        appDirs[MjClient.APP_TYPE.QXJSMJ] = "../client";
        appDirs[MjClient.APP_TYPE.YAAN] = "../client";
       
		var appDir = "";
		var appType = MjClient.getAppType();
    	if (appType in appDirs)
    		appDir = appDirs[appType];

        var searthPaths = jsb.fileUtils.getSearchPaths();
        for (var i = 0; i < searthPaths.length; i ++) {
        	if (searthPaths[i].indexOf(appDir) >= 0) {
        		appPath = searthPaths[i];
        		break;
        	}
        }
        cc.log("appPath=" + appPath + " appType=" + appType);
    }

    MjClient.Window_AppPath = appPath;
    MjClient.RESOURCE_ROOTDIR = writablePath;
    if (cc.sys.OS_WINDOWS != cc.sys.os) {
        jsb.fileUtils.addSearchPath("", false);
        jsb.fileUtils.addSearchPath(writablePath + MjClient.RESOURCE_DIR[0], false);
    	jsb.fileUtils.addSearchPath("res", false);
    }
    else {
    	if (MjClient.windowUpdate) {
    		jsb.fileUtils.addSearchPath(writablePath + MjClient.RESOURCE_DIR[0], false);
    		jsb.fileUtils.addSearchPath(appPath + "res", false);
    	}
    	else {
    		writablePath = appPath;
    	}
    	jsb.fileUtils.addSearchPath(writablePath + "res", false);
    }
    
    // for (var i = 1; i < MjClient.RESOURCE_DIR.length; i++) {
    //     if (MjClient.RESOURCE_DIR[i])
    //         jsb.fileUtils.addSearchPath(writablePath + MjClient.RESOURCE_DIR[i], false);
    // }

    var searthPaths = jsb.fileUtils.getSearchPaths();
    console.log("-------------initResourceDir end all searchPath:");
    for (var i = 0; i < searthPaths.length; i++) {
        console.log(searthPaths[i]);
    }

    cc.spriteFrameCache.addSpriteFrames("chat/emoji_action_texture.plist");
 	cc.spriteFrameCache.addSpriteFrames("chat/emoji.plist");
}

var sortSearchPath = function(gameType) {
	var searthPaths = jsb.fileUtils.getSearchPaths();
	var resourceClass = ResourceClass[GameClass[gameType]];
	var resourceDir = MjClient.RESOURCE_DIR[resourceClass];
	if (resourceClass == 0 || !resourceDir)
		return;

	searthPaths.sort(function(a, b) {
		if (a.indexOf(resourceDir) >= 0)
			return -1;
		else if (b.indexOf(resourceDir) >= 0)
			return 1;

		for (var i = 1; i < MjClient.RESOURCE_DIR.length; i++) {
			if (a.indexOf(MjClient.RESOURCE_DIR[i]) >= 0)
				return -1;
			else if (b.indexOf(MjClient.RESOURCE_DIR[i]) >= 0)
				return 1;
		}
		
		return 0;
	});

	setSearchPathByPaths(searthPaths, "sortSearchPath");
}

var resortSearchPath = function() {
	var searthPaths = jsb.fileUtils.getSearchPaths();

	searthPaths.sort(function(a, b) {
		for (var i = MjClient.RESOURCE_DIR.length - 1; i > 0; i--) {
			if (a.indexOf(MjClient.RESOURCE_DIR[i]) >= 0)
				return 1;
			else if (b.indexOf(MjClient.RESOURCE_DIR[i]) >= 0)
				return -1;
		}
		
		return 0;
	});

	setSearchPathByPaths(searthPaths, "resortSearchPath");
}

var setSearchPath = function(gameType) {
	var searthPaths = jsb.fileUtils.getSearchPaths();
	var resourceClass = ResourceClass[GameClass[gameType]];
	var resourceDir = MjClient.RESOURCE_DIR[resourceClass];
	if (resourceClass == 0 || !resourceDir)
		return;

	for (var i = searthPaths.length - 1; i >= 0; i--) {
		for (var j = 1; j < MjClient.RESOURCE_DIR.length; j++) {
			if (searthPaths[i].indexOf(MjClient.RESOURCE_DIR[j]) >= 0) {
				searthPaths.splice(i, 1);
				break;
			}
		}
	}
    if (cc.sys.OS_WINDOWS != cc.sys.os || MjClient.windowUpdate){
        searthPaths.unshift(MjClient.RESOURCE_ROOTDIR + resourceDir);
	}else{
        searthPaths.unshift(MjClient.Window_AppPath + resourceDir);
	}

	setSearchPathByPaths(searthPaths, "setSearchPath");
}

var setSearchPathByPaths = function(searthPaths, tag) {
    jsb.fileUtils.setSearchPaths(searthPaths);

    tag = tag || "searchPaths";
    searthPaths = jsb.fileUtils.getSearchPaths();
    cc.log(tag + " paths:");
    for (var i = 0; i < searthPaths.length; i++) {
        cc.log(searthPaths[i]);
    }
}
var MjClient = {}

var RemoveRoomView;
var StopRoomView;
var WebViewLayer;
var InfoLayer;
var PlayLogView;
var PlayerInfoView;
var LoginView;
var UpdateView;
var CreateView;
var ChangeUidView;
var ExportDataView;
function postEvent(eName,ePara){ cc.eventManager.dispatchCustomEvent(eName,ePara); }
function createSpine(skeletonDataFile, atlasFile){
	if (cc.ENGINE_VERSION.indexOf("3.16") >= 0)
        return sp.SkeletonAnimation.createWithJsonFile(skeletonDataFile, atlasFile);
	else
        return new sp.SkeletonAnimation(skeletonDataFile, atlasFile);
}



var g_ErrorCode =
	[
		"null",
		"没有可用的连接",
		"请求发生异常",
		"消息数组为空",
		"消息为空",
		"获取配置信息失败",
		"网络异常",//"pomelo异常",
		"获取主机端口失败",
		"8",
		"9",
		"没有版本号",
		"下载版本失败",
		"读取版本号失败",
		"NEW_VERSION_FOUND",
		"ALREADY_UP_TO_DATE",
		"UPDATE_PROGRESSION",
		"更新资源错误",
		"更新过程中断",
		"UPDATE_FINISHED",
		"更新失败",
		"解压失败"
	];




var logCount=0;
function mylog(txt)
{
	if( cc.sys.OS_WINDOWS != cc.sys.os ) return;
	if(!MjClient.Scene) return;
	var size = MjClient.size;
	var helloLabel = new cc.LabelTTF(txt, "Arial", 20);
	// position the label on the center of the screen
	helloLabel.x = size.width / 2;
	helloLabel.y = - (50*logCount);
	// add the label as a child to this layer
	MjClient.Scene.addChild(helloLabel);
	logCount++;
	helloLabel.zIndex=2000;
	helloLabel.runAction(cc.sequence(cc.moveBy(10,0,size.height),cc.callFunc(function(){ helloLabel.removeFromParent(true);  logCount--; })));
}


function setWgtLayout(wgt,pct,pos,off,isMax,isPar)
{

	if(!wgt) {
		cc.log('setWgtLayout wgt is null')
		return;
	}

	var screen=MjClient.size;
	var cutsize={width:0,height:0};
	var scPar=1;
	if(isPar)
	{
		var min={};
		var psize= {width:wgt.parent.width,height:wgt.parent.height};      //wgt.parent.getSize();
		scPar=wgt.parent.scale;

		cutsize.width=Math.max(0,(psize.width*scPar-screen.width)/2);
		cutsize.height=Math.max(0,(psize.height*scPar-screen.height)/2);

		min.width=Math.min(screen.width,psize.width*scPar);
		min.height=Math.min(screen.height,psize.height*scPar);
		screen=min;
		//mylog(screen.width+" "+screen.height);
	}
	
	var size={width:wgt.width,height:wgt.height}; //wgt.getSize();
	
	if (size.width == 0 || size.height == 0)
		return;

	var sw=screen.width*pct[0]/size.width,sh=screen.height*pct[1]/size.height;
	
	if(isMax==true)
	{
		var sc=Math.max(sw,sh);
		sw=sc; sh=sc;
	}
	else if(isMax==2)
	{
		
	}
	else if(sw!=0&&sh!=0)
	{
		var sc=Math.min(sw,sh);
		sw=sc; sh=sc;
	}
	else 
	{
		var sc=Math.max(sw,sh);
		sw=sc; sh=sc;
	}

	sw/=scPar;	sh/=scPar;		 
	wgt.scaleX=sw; wgt.scaleY=sh;
	wgt.setPosition( 
	                 cutsize.width/scPar+screen.width*pos[0]/scPar +off[0]*size.width*sw,
	                 cutsize.height/scPar+screen.height*pos[1]/scPar+off[1]*size.height*sh
				   );
}

function UIEventBind(pjs,node,evt,func)
{
	if(!node) return MjClient.showToast("当前节点不存在 节点注册事件名字： " +  evt);

	cc.eventManager.addListener(cc.EventListener.create({
			  event: cc.EventListener.CUSTOM,
			  eventName: evt,
			  callback: function(et)
			  { 
			      func.call(node,et.getUserData(),evt);   
			  }}), node);
   		   if(evt=="resize") func.call(node);
}
var FunctionBind={
	_event:function(pjs,node,js) {
		for(var evt in js) {
			UIEventBind(pjs,node,evt,js[evt]);
		   //cc.eventManager.addCustomListener(evt,func);
		}
	},
	_index:function(pjs, node, js){
		node.zIndex = js;
	},
	_touch:function(pjs,node,js) {
		node.addTouchEventListener(js,node);
	},
	_click:function(pjs,node,js) {
		node.addTouchEventListener(function(btn,eT)
		{ 
        	if(eT==2)
			{
				js(btn,eT);
			}				
		},node);
	}
	,_visible:function(pjs,node,js)
	{
		if(typeof js=="function") node.visible=js();
		else node.visible=js;
	}
	,_keyboard:function(pjs,node,js)
	{
		cc.eventManager.addListener({
                event: cc.EventListener.KEYBOARD,
                onKeyPressed: js.onKeyPressed,
                onKeyReleased:js.onKeyReleased, 
            }, node);
	}
	,_check:function(pjs,node,js)
	{
	   	node.addEventListener(js,pjs);
	}
	,_layout:function(pjs,node,js)
	{
	   var ar=[node];  for(var i=0;i<js.length;i++)ar.push(js[i]);
	   UIEventBind(pjs,node,"resize",function(){
		   setWgtLayout.apply(node,ar);
	   });
	},
	_text:function(pjs,node,js)
	{
		node.setString(js())
		
	},
	_run:function(pjs,node,js)
	{
		js.call(node);
	}
	,_slider:function(pjs,node,js)
	{
		node.addEventListener(js,node);
	}
	,_listener:function(pjs,node,js)
	{
		node.addEventListener(js,node);
	}
}

function BindUiAndLogic(node,js)
{
	if(node==null) return;

	for(var cd in js)
	{
		if(cd.substr(0,1)=="_")
		{

			var func=FunctionBind[cd];
			if(func) func(js,node,js[cd]);//js:{"_layout":[[1,1],[0.5,0.5],[0,0],true]}   node:{}  js[cd]:1,1,0.5,0.5,0,0,true
		}
		else
		{
			BindUiAndLogic( node.getChildByName(cd) , js[cd]);
		}
	}
	js._node=node;
}


/*
 * 打印 JavaScript 函数调用堆栈
 */
function printCallStack(count) {
    var caller = arguments.callee.caller;
    var i = 0;
    count = count || 10;
    cc.log("***----------------------------------------  ** " + (i + 1));
    while (caller && i < count) {
        cc.log(caller.toString());
        caller = caller.caller;
        i++;
        cc.log("***---------------------------------------- ** " + (i + 1));
    }
}